\section{Code listing} % (fold)
\label{app:code_listing}

\lstset{basicstyle=\rm\footnotesize\ttfamily}

%%%%%%%%%%%%%%%%% OBSERVER PATTERN %%%%%%%%%%%%%%%%%
\begin{lstlisting}[caption=\emph{Observer} pattern for \texttt{Customer} and \texttt{Meal}.,
label=lst:observer]
public interface Observer {
  public void update(Meal specMeal, Restaurant r);
}

public class Customer extends User implements Observer {
  private boolean beNotified = true;
  public void update(Meal specMeal, Restaurant r){
    if (beNotified){
       System.out.println("[Customer UPDATE] " + ...);
} } }

public class Core {
  private void notifyCustomersOfSpecialOffer(){
    for(Customer cust : customerList){
      if (users.containsKey(cust.getUsername())){
        cust.update(current_restaurant);
} } } }
\end{lstlisting}

%%%%%%%%%%%%%%%%% STRATEGY PATTERN %%%%%%%%%%%%%%%%% strategy (fold)
\begin{lstlisting}[caption=\emph{Strategy} pattern for the \lstinline|DeliveryPolicy|.,
label=lst:strategy]
public interface DeliveryPolicy {
  public <G> ArrayList<Courier> howToDeliver(ArrayList<Courier> list, G g); 
}

public class FairOccupationDelivery implements DeliveryPolicy {
  private ArrayList<Courier> listCourier;
  
  public FairOccupationDelivery() {
  	super();
  	listCourier = new ArrayList<Courier>();
  }
  
  public <G> ArrayList<Courier> howToDeliver(ArrayList<Courier> list, G g) {
  	...
  }
}

public class FastestDelivery implements DeliveryPolicy {
  private ArrayList<Courier> courierListSorted;
  private ArrayList<Double> courierDistanceList;

  public FastestDelivery() {
  	super();
  	courierListSorted = new ArrayList<Courier>();
  	courierDistanceList = new ArrayList<Double>();
  }
 
  @Override
  public <G> ArrayList<Courier> howToDeliver(ArrayList<Courier> list, G g) {
  	...
  }
  
  public void getDistance(ArrayList<Courier> courierList, Address address) {
    ...
  }
  
}
\end{lstlisting}

\begin{lstlisting}[caption=Aggregation applied to the \Core~and its policies.,
  label=lst:aggregationCore]
public class Core{
    private DeliveryPolicy dPolicy;
    private TargetProfitPolicy tpPolicy;
    private SortPolicy sortPolicy;
}
  
\end{lstlisting}

% strategy (end)

%%%%%%%%%%%%%%%%% CURRENT USER SYSTEM %%%%%%%%%%%%%%%%% current_user (fold)
\begin{lstlisting}[caption=Application of the \texttt{current\_customer}
  concept to \texttt{getHistoryOfOrders}.,
  label=lst:historyOfOrders]
/**
 * Returns the history of orders of the current user, null if none is logged in.
 * @return an ArrayList of orders containing the orders of the current user
 */
public ArrayList<Order> getHistoryOfOrders() {
  if (current_customer != null){
    int temp_ID = current_customer.getID();
    ArrayList<Order> temp_cust_orders = new ArrayList<Order>();
    for(Order o : savedOrders){
      if (temp_ID == o.getCustomer().getID()){
        temp_cust_orders.add(o);
      }
    }
    return temp_cust_orders;
  } else {
    unauthorizedCommand();
    return null;
  }
}
\end{lstlisting}

%%%%%%%%%%%%%%%%% LOGIN / LOGOUT SYSTEM %%%%%%%%%%%%%%%%% current_user (fold)
\begin{lstlisting}[caption=the main methods for the log in log out system.,
  label=lst:login]
/**
* This method allows registered users to log in and changes the current user to the user 
* having completed the log in. New messages are printed out if user logs in.
* 
* @param username registered username that is saved in the system.
* @return a String containing a welcome message if the login was successful
* 		   or null if not
*/
public String logIn(String username){
  String output=null;
  if (users.containsKey(username)){
    current_user = users.get(username);
    if (current_user instanceof Courier){
    	current_courier = (Courier) current_user;
    	output = "Successfully logged in as a Courier !";
    } else if (current_user instanceof Customer){
    	current_customer = (Customer) current_user;
    	output = "Successfully logged in as a Customer !";
    } else if (current_user instanceof Manager){
    	current_manager = (Manager) current_user;
    	output = "Successfully logged in as a Manager !";
    } else if (current_user instanceof Restaurant){
    	current_restaurant = (Restaurant) current_user;
    	output = "Successfully logged in as a Restaurant !";
    }
    current_user.checkMessages(); 
  }
  return output;
}
\end{lstlisting}

\begin{lstlisting}[caption=the main methods for the log in log out system.,
  label=lst:logout]
/**
 * This method allows logged in users to log out.
 */
public void logOut(){
current_user = null;
current_courier = null;
current_customer = null;
current_manager = null;
current_restaurant = null;
}
\end{lstlisting}

% current_user (end)

%%%%%%%%%%%%%%%%% TEST EXAMPLES %%%%%%%%%%%%%%%%%
\begin{lstlisting}[caption=Example of a test using \texttt{assertEquals} with 2 decimal precision.,
  label=lst:test_total_income]
@Test
public void checkIfCalcTotalIncomeWorks() {
  make3orders();
  mf1.autoSetDateAfter();
  double totalIn = mf1.calcTotalIncome();
  //   3xdish1 : 3x8.3 = 24.9
  // + 2xdish2 : 2x6.35 = 12.7
  // + 1xdish3 : 1x16.85 = 16.85
  // + 3x(serviceFee + deliveryCost) : 3x2.5 = 7.5
  // ------------------------------------------------------
  // = 61.95
  assertEquals(totalIn, 61.95, 0.01);
  System.out.println("TEST chekcIfCalcTotalIncomeWorks : DONE\n");
}
\end{lstlisting}

% section code_listing (end)
  
  
  
\lstset{basicstyle=\rm\small\ttfamily}
